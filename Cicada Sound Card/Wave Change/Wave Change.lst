0000                             ;			Cicada Sound Card Wave Change
0000                             ;			Vernon Billingsley c2024
0000                             ; 
0000                             ;	A sample program for the Cicada Sound Card designed of the RC2014 Z80 single
0000                             ; 	board computer. The sound card should be in the default startup mode, ie MIDI mode,
0000                             ;	AR envelope mode, default GAIN..
0000                             ; 
8000                          .ORG   0x8000   
8000                             ; 
8000                PORT:     EQU   0x30   
8000                NOTE_ON:   EQU   0x01   
8000                NOTE_OFF:   EQU   0x00   
8000                TRI:      EQU   0x02   
8000                SAW:      EQU   0x03   
8000                SQU:      EQU   0x04   
8000                             ; 
8000                START:       
8000   3E 02                  LD   a,TRI   ;Load Triange wave command
8002   D3 30                  OUT   (0x30),a   
8004                             ;			
8004   01 01 00               LD   bc,0x01   ;Load a short delay to allow the arduino to read the bus
8007   CD 73 80               CALL   delay   
800A                             ;			
800A   3E 9B                  LD   a,0x9b   ;Load the Middle C note to the A register
800C   D3 30                  OUT   (0x30),a   ;Send to the bus
800E                             ; 
800E   01 01 00               LD   bc,0x01   ;Load a short delay to allow the arduino to read the bus
8011   CD 73 80               CALL   delay   
8014                             ; 
8014   3E 01                  LD   a,NOTE_ON   
8016   D3 30                  OUT   (0x30),a   
8018                             ; 
8018   01 00 02               LD   bc,0x200   ;Turn note on for aprox. 1/2 second
801B   CD 73 80               CALL   delay   
801E                             ; 
801E   3E 00                  LD   a,NOTE_OFF   
8020   D3 30                  OUT   (0x30),a   
8022                             ; 
8022   01 00 01               LD   bc,0x100   ;Turn note off for aprox. 1/4 second
8025   CD 73 80               CALL   delay   
8028                             ; 
8028   3E 03                  LD   a,SAW   ;Load Triange wave command
802A   D3 30                  OUT   (0x30),a   
802C                             ;			
802C   01 01 00               LD   bc,0x01   ;Load a short delay to allow the arduino to read the bus
802F   CD 73 80               CALL   delay   
8032                             ;			
8032   3E 9B                  LD   a,0x9b   ;Load the Middle C note to the A register
8034   D3 30                  OUT   (0x30),a   ;Send to the bus
8036                             ; 
8036   01 01 00               LD   bc,0x01   ;Load a short delay to allow the arduino to read the bus
8039   CD 73 80               CALL   delay   
803C                             ; 
803C   3E 01                  LD   a,NOTE_ON   
803E   D3 30                  OUT   (0x30),a   
8040                             ; 
8040   01 00 02               LD   bc,0x200   ;Turn note on for aprox. 1/2 second
8043   CD 73 80               CALL   delay   
8046                             ; 
8046   3E 00                  LD   a,NOTE_OFF   
8048   D3 30                  OUT   (0x30),a   
804A                             ; 
804A   01 00 01               LD   bc,0x100   ;Turn note off for aprox. 1/4 second
804D   CD 73 80               CALL   delay   
8050                             ; 
8050   3E 04                  LD   a,SQU   ;Load Triange wave command
8052   D3 30                  OUT   (0x30),a   
8054                             ;			
8054   01 01 00               LD   bc,0x01   ;Load a short delay to allow the arduino to read the bus
8057   CD 73 80               CALL   delay   
805A                             ;			
805A   3E 9B                  LD   a,0x9b   ;Load the Middle C note to the A register
805C   D3 30                  OUT   (0x30),a   ;Send to the bus
805E                             ; 
805E   01 01 00               LD   bc,0x01   ;Load a short delay to allow the arduino to read the bus
8061   CD 73 80               CALL   delay   
8064                             ; 
8064   3E 01                  LD   a,NOTE_ON   
8066   D3 30                  OUT   (0x30),a   
8068                             ; 
8068   01 00 02               LD   bc,0x200   ;Turn note on for aprox. 1/2 second
806B   CD 73 80               CALL   delay   
806E                             ; 
806E   3E 00                  LD   a,NOTE_OFF   
8070   D3 30                  OUT   (0x30),a   
8072                             ;			
8072   C9                     RET      
8073                             ; 
8073                             ; 
8073                             ; 
8073                             ;*** Delay, aprox 250 mS per 0x100
8073                             ;    Counts loaded into register BC before call
8073                DELAY:       
8073                OUTER:       
8073   11 00 02               LD   de,0x200   
8076                INNER:       
8076   1B                     DEC   de   
8077   7A                     LD   a,d   
8078   B3                     OR   e   
8079   C2 76 80               JP   nz,inner   
807C   0B                     DEC   bc   
807D   78                     LD   a,b   
807E   B1                     OR   c   
807F   C2 73 80               JP   nz,outer   
8082   C9                     RET      
8083                             ; 
8083                             ; 


PORT:               0030 DEFINED AT LINE 10
NOTE_ON:            0001 DEFINED AT LINE 11
                    > USED AT LINE 30
                    > USED AT LINE 54
                    > USED AT LINE 78
NOTE_OFF:           0000 DEFINED AT LINE 12
                    > USED AT LINE 36
                    > USED AT LINE 60
                    > USED AT LINE 84
TRI:                0002 DEFINED AT LINE 13
                    > USED AT LINE 18
SAW:                0003 DEFINED AT LINE 14
                    > USED AT LINE 42
SQU:                0004 DEFINED AT LINE 15
                    > USED AT LINE 66
START:              8000 DEFINED AT LINE 17
DELAY:              8073 DEFINED AT LINE 93
                    > USED AT LINE 22
                    > USED AT LINE 28
                    > USED AT LINE 34
                    > USED AT LINE 40
                    > USED AT LINE 46
                    > USED AT LINE 52
                    > USED AT LINE 58
                    > USED AT LINE 64
                    > USED AT LINE 70
                    > USED AT LINE 76
                    > USED AT LINE 82
OUTER:              8073 DEFINED AT LINE 95
                    > USED AT LINE 105
INNER:              8076 DEFINED AT LINE 97
                    > USED AT LINE 101
